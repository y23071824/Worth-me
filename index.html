
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>值得我 我值得</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; margin-top: 20px; }
    .day {
      padding: 10px;
      border: 1px solid #ccc;
      text-align: center;
      border-radius: 8px;
      background-color: white;
      cursor: pointer;
      position: relative;
    }
    .day:hover { background-color: #fce4ec; }
    .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      position: absolute;
      bottom: 5px;
      left: 50%;
      transform: translateX(-50%);
    }
    .summary {
      font-size: 14px;
      color: #555;
      margin-top: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .header { display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 20px; }
    select { padding: 6px; border-radius: 6px; }
  </style>
</head>
<body>
  <h1>值得我 我值得</h1>
  <div class="header">
    <select id="year"></select>
    <select id="month"></select>
  </div>
  <div id="calendar" class="calendar"></div>

  <script>
    const yearSelect = document.getElementById('year');
    const monthSelect = document.getElementById('month');
    const calendar = document.getElementById('calendar');

    for (let y = 2020; y <= 2030; y++) {
      const option = document.createElement('option');
      option.value = y;
      option.textContent = y + " 年";
      yearSelect.appendChild(option);
    }

    for (let m = 1; m <= 12; m++) {
      const option = document.createElement('option');
      option.value = m;
      option.textContent = m + " 月";
      monthSelect.appendChild(option);
    }

    function renderCalendar() {
      const year = parseInt(yearSelect.value);
      const month = parseInt(monthSelect.value);
      const daysInMonth = new Date(year, month, 0).getDate();
      calendar.innerHTML = "";

      for (let d = 1; d <= daysInMonth; d++) {
        const day = d.toString().padStart(2, '0');
        const monthStr = month.toString().padStart(2, '0');
        const key = `${year}-${monthStr}-${day}`;
        const saved = JSON.parse(localStorage.getItem(key) || '{}');
        const div = document.createElement('a');
        div.className = 'day';
        div.href = `daily.html?date=${key}`;
        div.innerHTML = day;

        if (saved.emotionColor) {
          const dot = document.createElement('div');
          dot.className = 'dot';
          dot.style.backgroundColor = saved.emotionColor;
          div.appendChild(dot);
        }

        if (saved.text) {
          const summary = document.createElement('div');
          summary.className = 'summary';
          summary.textContent = saved.text.slice(0, 20);
          div.appendChild(summary);
        }

        calendar.appendChild(div);
      }
    }

    yearSelect.onchange = renderCalendar;
    monthSelect.onchange = renderCalendar;

    const today = new Date();
    yearSelect.value = today.getFullYear();
    monthSelect.value = today.getMonth() + 1;
    renderCalendar();
  </script>
</body>
</html>
